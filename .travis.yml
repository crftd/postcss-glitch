language: node_js
sudo: false
cache: yarn
node_js:
- '10.5'
git:
  depth: 2
jobs:
  include:
  - script:
      - yarn lint
      - yarn test
  - stage: npm
    script: yarn build
    deploy:
      provider: npm
      skip_cleanup: true
      email: hex22a@gmail.com
      api_key:
        secure: dYlG9IkiQzns1iGI/fHt9AW1fFCn//OxsNiVY06TpZcvWXKbAHLQEtjogkqYPP/Jc+rOLQMlfAGync8FLjvTYdV4FJxKW5Vxts561odPrWTjl+utS5e+Csg0n/vX52YDGHGtH+8pxKp5QzBAAA3UdliHyMCRCvuPHRdk0nXleAepX1t0fyuuQJkIcogow766EuxBTtCv7qYJz/Y8WJ9p+CrJpCmtCkqoszYCUdXdSyUCDF5bIPtx6r0CFTKoUtkm1PEVlp8l/hUJm0r5PzjnVb1BMPti3uLGm2t07Mf37Bo8VEzHgsqoHfSuHP2fJewfRdOK0wJ2mz9wQEQvn4IfbheOQK45jCLP97o3ch8p5a4wRhs0hhqbg16mZ+14uqNY0iNox0Ykbm5iBbbUDfjuGDcWfeuAbWNk8F9tJAomE0IqnE/pAQsFpPKhDbUzqOZGsyLEh+EaKGNMlPGiPzl+JImlXVRlCgleuJ94ZUIqsEBJBrbGIVsAlLJwlaPJTXOtAFIoSAXnqqa3aAhgrQvncr6RrsPDztId+8KTO48nH7WAx/3bnvz0NULvRobpcIGnhCuaNaDaouPj2d9CzTiQyfVF9SH0CobqvdBH5wMRkIjj9n+tNRJ95eSvoAFpXdzlbn7+5b8CtbpxN8y/hhkpPRGcgiwzViZeFK3SS3e8ycM=
      on:
        tags: true
        repo: crftd/postcss-glitch
  - stage: github
    install:
      - cd ./demo
      - yarn install
    script:
      - yarn build
    deploy:
      provider: pages
      local_dir: ./demo/dist
      skip_cleanup: true
      github_token:
        secure: M6HYYCkeFzmQtYcSoITNTJfGJtFstQjYQpCr4F+9xw8wP+0Ahm5S5T3KVrxChuVLR7C5Y2BX2bJ+Qip9vR0oKUXVRP6Lg5FrVWv6IqypK1PpIV5X35jVCrXKBNexA+l7dGwdRgpnkHL1xirK7M1cQL+x0D/bmbZrae/qAQiYSb4lFbG0/pJqMFJYXGqSD9AHi8YCPqKo506ed+/y5TPJE3kG4xyH/xcxTGs8zda4v4XnVF0fkQu31TwEIf4CcMipq6M/xCmkYkDDl00Rw++reIdrdg1PxJE9f0YvqMb+fzchQg5SXZ9BNtobWPIju6fB7LQ3XJ4lEkYtw4zeeutEKa+kRgWqbkUgvlxcnnZUHL5mBZwptbo0N8sqxbUrWocAcrv541YJ4WUkG39wORXqBXBbNfCNq185nQlyScmiGeIyGMeEWv7AGqGVsftqQYHqKtTaqWwViIgwF3PMRpM9deNMu/e7k1N0P1Z1bP/Qs/sGSWf6UFkkxtLiIJfUCo1hx8jfMpifJLbdIRO7li88kX/mhyuwGbceCbWhuGZzyEShLoSEGED2mxcEYuuitXegcBsjsAUfMg3LFRztoTF+ZRgegsjZzBCJpL+ORA5HHo12g59ieX7UzDG1YvG8QK1obg+Lh4Q3LME2uJ51k6HUA0XSbyXA4jj4pikHaEPrQlE=
      on:
        tags: true
        branch: master
