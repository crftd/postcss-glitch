language: node_js
sudo: false
cache: yarn
node_js:
- '10.5'
git:
  depth: 2
jobs:
  include:
  - script: yarn test && yarn build:dev
  - stage: npm
    script: yarn build
    deploy:
      provider: npm
      skip_cleanup: true
      email: hex22a@gmail.com
      api_key:
        secure: dYlG9IkiQzns1iGI/fHt9AW1fFCn//OxsNiVY06TpZcvWXKbAHLQEtjogkqYPP/Jc+rOLQMlfAGync8FLjvTYdV4FJxKW5Vxts561odPrWTjl+utS5e+Csg0n/vX52YDGHGtH+8pxKp5QzBAAA3UdliHyMCRCvuPHRdk0nXleAepX1t0fyuuQJkIcogow766EuxBTtCv7qYJz/Y8WJ9p+CrJpCmtCkqoszYCUdXdSyUCDF5bIPtx6r0CFTKoUtkm1PEVlp8l/hUJm0r5PzjnVb1BMPti3uLGm2t07Mf37Bo8VEzHgsqoHfSuHP2fJewfRdOK0wJ2mz9wQEQvn4IfbheOQK45jCLP97o3ch8p5a4wRhs0hhqbg16mZ+14uqNY0iNox0Ykbm5iBbbUDfjuGDcWfeuAbWNk8F9tJAomE0IqnE/pAQsFpPKhDbUzqOZGsyLEh+EaKGNMlPGiPzl+JImlXVRlCgleuJ94ZUIqsEBJBrbGIVsAlLJwlaPJTXOtAFIoSAXnqqa3aAhgrQvncr6RrsPDztId+8KTO48nH7WAx/3bnvz0NULvRobpcIGnhCuaNaDaouPj2d9CzTiQyfVF9SH0CobqvdBH5wMRkIjj9n+tNRJ95eSvoAFpXdzlbn7+5b8CtbpxN8y/hhkpPRGcgiwzViZeFK3SS3e8ycM=
      on:
        tags: true
        repo: crftd/postcss-glitch
  - stage: github
    install:
      - cd ./demo
      - yarn install
    script:
      - yarn build
    deploy:
      provider: pages
      local_dir: ./demo/dist
      skip_cleanup: true
      github_token:
        secure: QQsvjg/wdXe8JatkoGvyQuyphTQoPw8jioMWv44mb7YxDF31D2v7f3nKRD3olLAW93wlp2pbkVTcSl5oDmQ9xO7III5uQ5dwNDB0RwxrSAlnK4RtgXaAEwy4gO9tb106HKnworB4m48U7f+K8aOXTd0CiFQiDRK2QDwGwd4mdlWxXLAvASmeE305gj2LuqsMWaRJXNPG162xvthfuFw5hJu4PIPMsau6gsUXaw7m8ck87UMnNtC75Ina8hO6Ye0SziHdPwVYPzBdmG904RqbJyOGsMgmIv29z3J4zRYHtCArkiYqNz8zkv/IaCnabfUVWimYUlSu2u+3j00spMq4MIMc/ktGRoFK6DYJsOiqLtt2ETb4WHiccL/rtNXeRmhfiOnqPlwnkxZRG0VUOIEge4kRF0+OQCORM0RucAuvgQFjdwyxOogm9Qt3Cg46z91T7zISfYY0HK6lU9UDJK4DY2Z4pYGTS3vP5DNjo+fccsfVMvPbYvUOF2EpOvDEVX1Qrj1vqs2fNUdSrEUTUXIrdOBJz5qyFfHHOqxnX9wXaT+wS+6/BO7JxwH8/frpdAulZuudaQV6MNrCIHf4EQaG/WymO4znKN37y1BeFEMPHRynIYqF3exexT5R6vLENJCVq1xoAJ6SCA4FkQRv2nDPtSU4/fzpUpniD9D8ZkPgrG8=
      on:
        tags: true
        branch: master
