language: node_js
sudo: false
cache: yarn
node_js:
  - 12
git:
  depth: 2
jobs:
  include:
    - script:
        - yarn lint
        - yarn test
    - stage: npm
      script: yarn build:ci
      deploy:
        provider: npm
        edge: true
        skip_cleanup: true
        email: hex22a@gmail.com
        api_key:
          secure: Gv4fwux0xEQUIpwKK/i+w1GdwAq8pjSm5o7rzhRQsAVCRAEeOeTDqxijK2AO3obPcaQiCYyjuO6tXd8GEe2mQSQqXBkkx5ypugzMyFmUFA2eh1GUJyxWTjZRlMXB1v3oPjTt9XFxdKJXcxay5PC5yNqyaLENSaPYlhwJqOhvloeQmfRgmvjjavgbVp8+pjl+Ngg1xMwLs7f1UYQFhqLZR9xBFAk6UaQDu0LxnjTBQuATTsGiyl3pT5374rzpu/VroFaKa+34JjsNKjtvplYheMMnLEkg5sjrhXG0KjuuJrsq1/pxg138t90SFfj8HfLL+EC1l69ButRSxvDK3NCsrUNi77No9QbeSEimvHE9cg62NsgzYrH7YlogVRIXYu7T082wDEDw/TtAEKaAkMiahWgRDLbvOVmivQ6qwzK2P+rdu1P8kuO8LAyHCh9uUDSpjWXwDmydBA56l+dC3s2iaKES8wAOXZpCcCYepJa+Bo4CIBzHAM5U06327QmPCYz4UW5/q4+7omNhgzBhmR2NJijyGpU52O4X+jkPcEQAJO/UjDk0lX7Bt2WztGEPKJzRCNU+mLVMXBhcMKT9YRW53syIHGQO0zJ75dKvBwkCUfI2Oo9ZaTPStiMYBulyCzd1DtsMN3CPsjt2T3uez0izqfGYqL136m2TQVHbuTAeZL0=
        on:
          tags: true
          repo: crftd/postcss-glitch
    - stage: github
      install:
        - cd ./demos/simple
        - yarn install
      script:
        - yarn build
      deploy:
        provider: pages
        local_dir: ./demos/simple/dist
        skip_cleanup: true
        github_token:
          secure: M6HYYCkeFzmQtYcSoITNTJfGJtFstQjYQpCr4F+9xw8wP+0Ahm5S5T3KVrxChuVLR7C5Y2BX2bJ+Qip9vR0oKUXVRP6Lg5FrVWv6IqypK1PpIV5X35jVCrXKBNexA+l7dGwdRgpnkHL1xirK7M1cQL+x0D/bmbZrae/qAQiYSb4lFbG0/pJqMFJYXGqSD9AHi8YCPqKo506ed+/y5TPJE3kG4xyH/xcxTGs8zda4v4XnVF0fkQu31TwEIf4CcMipq6M/xCmkYkDDl00Rw++reIdrdg1PxJE9f0YvqMb+fzchQg5SXZ9BNtobWPIju6fB7LQ3XJ4lEkYtw4zeeutEKa+kRgWqbkUgvlxcnnZUHL5mBZwptbo0N8sqxbUrWocAcrv541YJ4WUkG39wORXqBXBbNfCNq185nQlyScmiGeIyGMeEWv7AGqGVsftqQYHqKtTaqWwViIgwF3PMRpM9deNMu/e7k1N0P1Z1bP/Qs/sGSWf6UFkkxtLiIJfUCo1hx8jfMpifJLbdIRO7li88kX/mhyuwGbceCbWhuGZzyEShLoSEGED2mxcEYuuitXegcBsjsAUfMg3LFRztoTF+ZRgegsjZzBCJpL+ORA5HHo12g59ieX7UzDG1YvG8QK1obg+Lh4Q3LME2uJ51k6HUA0XSbyXA4jj4pikHaEPrQlE=
        on:
          tags: true
          branch: master
