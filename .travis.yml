language: node_js
sudo: false
cache: yarn
node_js:
- '10.5'
git:
  depth: 2
jobs:
  include:
  - script: yarn test && yarn build:dev
  - stage: npm
    script: yarn build
    deploy:
      provider: npm
      skip_cleanup: true
      email: hex22a@gmail.com
      api_key:
        secure: dYlG9IkiQzns1iGI/fHt9AW1fFCn//OxsNiVY06TpZcvWXKbAHLQEtjogkqYPP/Jc+rOLQMlfAGync8FLjvTYdV4FJxKW5Vxts561odPrWTjl+utS5e+Csg0n/vX52YDGHGtH+8pxKp5QzBAAA3UdliHyMCRCvuPHRdk0nXleAepX1t0fyuuQJkIcogow766EuxBTtCv7qYJz/Y8WJ9p+CrJpCmtCkqoszYCUdXdSyUCDF5bIPtx6r0CFTKoUtkm1PEVlp8l/hUJm0r5PzjnVb1BMPti3uLGm2t07Mf37Bo8VEzHgsqoHfSuHP2fJewfRdOK0wJ2mz9wQEQvn4IfbheOQK45jCLP97o3ch8p5a4wRhs0hhqbg16mZ+14uqNY0iNox0Ykbm5iBbbUDfjuGDcWfeuAbWNk8F9tJAomE0IqnE/pAQsFpPKhDbUzqOZGsyLEh+EaKGNMlPGiPzl+JImlXVRlCgleuJ94ZUIqsEBJBrbGIVsAlLJwlaPJTXOtAFIoSAXnqqa3aAhgrQvncr6RrsPDztId+8KTO48nH7WAx/3bnvz0NULvRobpcIGnhCuaNaDaouPj2d9CzTiQyfVF9SH0CobqvdBH5wMRkIjj9n+tNRJ95eSvoAFpXdzlbn7+5b8CtbpxN8y/hhkpPRGcgiwzViZeFK3SS3e8ycM=
      on:
        tags: true
        repo: crftd/postcss-glitch
  - stage: github
    install:
      - cd ./demo
      - yarn install
    script:
      - yarn build
    deploy:
      provider: pages
      local_dir: ./demo/dist
      skip_cleanup: true
      github_token:
        secure: OMK4arjIPQezBm7QjbG+Goa9L9/yYKycOZ/6kwFE273GA1loQng0mZze37RikWs7w02dF+HHACOGDFz+Onk+AMwbvYHOaF5O769OwlnJ3f4KKx9dpNgfu5Sn49hMsudj/Egs/GdzQ6c/fVq9Y4aYHs8TbVqd6osWS+o0aGAxXCkuB0MFgJCntKRWiBhfSMMPWId6bedxM3lOUv8t85UJyw4lLEh4pAvAZhD9TiDsCoDHU7b3Bzi/1TOqUMQWF8pj9FoMX0erMcRo3O8qE2V63eLmKfVCmMTw1dDlblmLr1H1GgrHKi/az3B4IRSY5aWZj2gALCGJCJ1YDuH8dGDoSqadhDKWMJqrpOtOdTJSS4F2KN5US/MFcrXgq3Iv7V9+OvXh81SdVWrVD06yOCqL67L6Z2b+Be41QK3FXO6k6DSJ5UJ4GVUcpmWR4Cwbun45511TDDPrKUR4z9/sVKY+PjvqEcMXE5OdTlSYj0LpTsc7z/TSYrFfvLkMdwEfIe2WxiNZ2uYAhJAbR0BgxtE4l0x3CPRdf+8PwZZ7S1HVmUVpnoMbbgRh8MP/3vuIcl9g1qUnabC8exkPuK2yEBKKTFaHIbnRV7G6KWWJuGCT3H7cUh3e+Xjpvm5RVSJya/gxnRST5uJzqGDRytf0cwHjFxg7n+eW+rqvsHC/5Zkq/Pw=
      on:
        tags: true
        branch: master
