language: node_js
sudo: false
cache: yarn
node_js:
  - 12
git:
  depth: 2
jobs:
  include:
    - script:
        - yarn lint
        - yarn test
    - stage: npm
      script: yarn build:ci
      deploy:
        provider: npm
        skip_cleanup: true
        email: hex22a@gmail.com
        api_key:
          secure: 'cLO1WbNKpb597kGtFk+p7gXrB1F7bfDXutejn2+MgDzDmRNbrINBSPUaABjjjdFF/9YHuODg+RCmXoa70Ga5RoxhtsS+ycweR2vqqWWxlxuiGiS44mRUlxBAjMQ/d1Rq8h5gCIVlFqK/KujEu3s6zb9nNny2Xqo93fdWKJEQTo5AKniAkqfbFl1KoAxIwMH5b2cI+V1MXpHfLOV08FSnjxfmdFa4ryYmjFx2/NAJxZxjpNnTob//djiwMGwi5MNCMdFW7b8o4jqdMFcOw2tJO2UU3nW+Jm1kxrT+ipIU4C9N5DbcgrV95CQwT26IcLp6FwRyiGEIl2Jan8AZyg6eYwZmkoCiyOPyVQxLoc9TXJTDv3V+CyUg0S8lKsKMy5Ky0c7TcO+9vuWqkcBL64Euwr80rF/j8JAYlVXVwflOfqq0OLpgCyXZRF/AtAuVAJXHDGJkMkPdn2BLnCb6U85HzLpaaSeP/z50bZtyaifZWvUKvslRohGFoZFdLh9T1nPYnyaDobcD56OWe5h9KfhzDTsnji5hO67559XBSlXDVhvwnwuvUJtigy3gU/nwhd8HKUaJe+W+6YTGdBS21U1XAUe5KRy//DXOx7GvFE8PBPNcsc14SobJ10Ckr/+Dn+u6XygN82dN42ySrTZ3VB3ATHSGs2MNkjBX+IiLFo9KUUM='
        on:
          tags: true
          repo: crftd/postcss-glitch
    - stage: github
      install:
        - cd ./demos/simple
        - yarn install
      script:
        - yarn build
      deploy:
        provider: pages
        local_dir: ./demos/simple/dist
        skip_cleanup: true
        github_token:
          secure: M6HYYCkeFzmQtYcSoITNTJfGJtFstQjYQpCr4F+9xw8wP+0Ahm5S5T3KVrxChuVLR7C5Y2BX2bJ+Qip9vR0oKUXVRP6Lg5FrVWv6IqypK1PpIV5X35jVCrXKBNexA+l7dGwdRgpnkHL1xirK7M1cQL+x0D/bmbZrae/qAQiYSb4lFbG0/pJqMFJYXGqSD9AHi8YCPqKo506ed+/y5TPJE3kG4xyH/xcxTGs8zda4v4XnVF0fkQu31TwEIf4CcMipq6M/xCmkYkDDl00Rw++reIdrdg1PxJE9f0YvqMb+fzchQg5SXZ9BNtobWPIju6fB7LQ3XJ4lEkYtw4zeeutEKa+kRgWqbkUgvlxcnnZUHL5mBZwptbo0N8sqxbUrWocAcrv541YJ4WUkG39wORXqBXBbNfCNq185nQlyScmiGeIyGMeEWv7AGqGVsftqQYHqKtTaqWwViIgwF3PMRpM9deNMu/e7k1N0P1Z1bP/Qs/sGSWf6UFkkxtLiIJfUCo1hx8jfMpifJLbdIRO7li88kX/mhyuwGbceCbWhuGZzyEShLoSEGED2mxcEYuuitXegcBsjsAUfMg3LFRztoTF+ZRgegsjZzBCJpL+ORA5HHo12g59ieX7UzDG1YvG8QK1obg+Lh4Q3LME2uJ51k6HUA0XSbyXA4jj4pikHaEPrQlE=
        on:
          tags: true
          branch: master
