language: node_js
sudo: false
cache: yarn
node_js:
- '10.5'
git:
  depth: 2
jobs:
  include:
  - script: yarn test && yarn build:dev
  - stage: npm
    script: yarn build
    deploy:
      provider: npm
      skip_cleanup: true
      email: hex22a@gmail.com
      api_key:
        secure: dYlG9IkiQzns1iGI/fHt9AW1fFCn//OxsNiVY06TpZcvWXKbAHLQEtjogkqYPP/Jc+rOLQMlfAGync8FLjvTYdV4FJxKW5Vxts561odPrWTjl+utS5e+Csg0n/vX52YDGHGtH+8pxKp5QzBAAA3UdliHyMCRCvuPHRdk0nXleAepX1t0fyuuQJkIcogow766EuxBTtCv7qYJz/Y8WJ9p+CrJpCmtCkqoszYCUdXdSyUCDF5bIPtx6r0CFTKoUtkm1PEVlp8l/hUJm0r5PzjnVb1BMPti3uLGm2t07Mf37Bo8VEzHgsqoHfSuHP2fJewfRdOK0wJ2mz9wQEQvn4IfbheOQK45jCLP97o3ch8p5a4wRhs0hhqbg16mZ+14uqNY0iNox0Ykbm5iBbbUDfjuGDcWfeuAbWNk8F9tJAomE0IqnE/pAQsFpPKhDbUzqOZGsyLEh+EaKGNMlPGiPzl+JImlXVRlCgleuJ94ZUIqsEBJBrbGIVsAlLJwlaPJTXOtAFIoSAXnqqa3aAhgrQvncr6RrsPDztId+8KTO48nH7WAx/3bnvz0NULvRobpcIGnhCuaNaDaouPj2d9CzTiQyfVF9SH0CobqvdBH5wMRkIjj9n+tNRJ95eSvoAFpXdzlbn7+5b8CtbpxN8y/hhkpPRGcgiwzViZeFK3SS3e8ycM=
      on:
        tags: true
        repo: crftd/postcss-glitch
  - stage: github
    install:
      - cd ./demo
      - yarn install
    script:
      - yarn build
    deploy:
      provider: pages
      local_dir: ./demo/dist
      skip_cleanup: true
      github_token:
        secure: BZBBIuzql9skuMh6lCefq5tCP0yBbtHlQgwJ3vylB9BbcQScqWaVnN4eQbF7vT6MPwrryEd3iMLqberrhXV4c/vrTEGVvuRi6v3q3LdH5H2v9LPDggmV4m/qMRhYTFw8hvK9tHmUDZQrOUZM5LJaNthbAENoKz8S3Dcb2UWq5iT1jZEXWtA6UJuuQJ3cc9B02P2BIsj5lolbjm+vsq2KzybEk5qgSmWsqjurvlq1g8q34KU/OxUkFDRWPSLyfnHfwt+kUU0o28L7BtfcGZDIpl/VQl+OxO6vlWXaA+J0pQVwlZU69UnogqFwCE81XCv03XQm724DiMxdNx3gEuc5jEGSFvHHDv17Cfm/q+raj6+iTan0eF8Yfr1wBo1FjGV14WJk8XyeBOsjs/3ufIO7xjEODjdBHKpkhSGJQVNwm0cyXmMedOGtUYtVS14eoMBueWIPM6XaILLULR6G84EwVQ5sbnYk1o6dA/jZhzYY3Gio/pKn4H7ZHA+OjjEHCQ/kw0C6qTsyw44GlGjXQJuz/Yl0h1QZg4cKmJbLcSxPIMBotgeNBHhdZ8KoPZB6cbGiULEPEyYXrue85VhPL1chPatOgaViCPAJ4zO805ODkq2TiorRv4Rv8RwlOzM41va2qu7Mg49AUf6R3m9yMDjDLhYT5B74xJ5G9f54d7sLjr0=
      on:
        tags: true
        branch: master
