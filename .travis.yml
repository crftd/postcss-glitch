language: node_js
sudo: false
cache: yarn
node_js:
- '10.5'
git:
  depth: 2
jobs:
  include:
  - script:
      - yarn lint
      - yarn test
  - stage: npm
    script: yarn build
    deploy:
      provider: npm
      skip_cleanup: true
      email: hex22a@gmail.com
      api_key:
        secure: dYlG9IkiQzns1iGI/fHt9AW1fFCn//OxsNiVY06TpZcvWXKbAHLQEtjogkqYPP/Jc+rOLQMlfAGync8FLjvTYdV4FJxKW5Vxts561odPrWTjl+utS5e+Csg0n/vX52YDGHGtH+8pxKp5QzBAAA3UdliHyMCRCvuPHRdk0nXleAepX1t0fyuuQJkIcogow766EuxBTtCv7qYJz/Y8WJ9p+CrJpCmtCkqoszYCUdXdSyUCDF5bIPtx6r0CFTKoUtkm1PEVlp8l/hUJm0r5PzjnVb1BMPti3uLGm2t07Mf37Bo8VEzHgsqoHfSuHP2fJewfRdOK0wJ2mz9wQEQvn4IfbheOQK45jCLP97o3ch8p5a4wRhs0hhqbg16mZ+14uqNY0iNox0Ykbm5iBbbUDfjuGDcWfeuAbWNk8F9tJAomE0IqnE/pAQsFpPKhDbUzqOZGsyLEh+EaKGNMlPGiPzl+JImlXVRlCgleuJ94ZUIqsEBJBrbGIVsAlLJwlaPJTXOtAFIoSAXnqqa3aAhgrQvncr6RrsPDztId+8KTO48nH7WAx/3bnvz0NULvRobpcIGnhCuaNaDaouPj2d9CzTiQyfVF9SH0CobqvdBH5wMRkIjj9n+tNRJ95eSvoAFpXdzlbn7+5b8CtbpxN8y/hhkpPRGcgiwzViZeFK3SS3e8ycM=
      on:
        tags: true
        repo: crftd/postcss-glitch
  - stage: github
    install:
      - cd ./demo
      - yarn install
    script:
      - yarn build
    deploy:
      provider: pages
      local_dir: ./demo/dist
      skip_cleanup: true
      github_token:
        secure: bt6Dvw5SQBFnT6ruEev0kDXwSrSrLF82V+W8xL0KF+nM7I7t1e2ROTDvPdeAZRomKkf8yBIN7YLHt711dRgvISEKHeiwc7iNqzMrYvHp+S6Hg898ObAAiuPq8abTdQMXytudTqKSO1xsagVowv7f20HuEdqlwkDi3FWg8s4b0jdqmvdBr8jRWOYUFCNzJAbK4BRtId+1bXRTdCRRMCzAWCn3OqDEc1973pXFZN0JGL+Zg13RSgG17pgO+VXHxUkCrIqNfZUaueAbChyreTFBiglS8mXZ6eyNtHWx6bms/35qcEDmUf0TBuQcR9LM3521e//4raQ1ciF/qehfea0c1Fa5iMDnuV+UYxeoM5oAaubw2XppJPtu3aCW/FcgNKQ5m5maCdakKF7/NWHtTdBrau03+TbwJayInfoEuOWeJIq5bb1/9QTvIKEVjJlGb+jIdvbRxu43PAuXvKtdisNx2h2B9tkkiu0h72M3Tj+RGoWWOazosH76jgnOach0krQwlmfNhsquhlJ6M0wWr752LC0ZPmuK2B/yNla7W7J3pmZAKb2Cwa5XJ43u90WQGYEFyHw3ovPUyysPW/GTcriNdXEIAEMrNV6GogC7khiPHzKSBRNKiOigYeTuOqtDCoQYKOq/cpemD0WuaPRJRP2rtjtNNHA0XmsdiXrgib2udfk=
      on:
        tags: true
        branch: master
